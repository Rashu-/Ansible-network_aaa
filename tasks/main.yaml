---

- name: Check network device OS
  assert:
    that: >
      ansible_network_os == 'nxos' or
      ansible_network_os == 'ios'
    msg: Network device OS not defined 

- name: Configure aaa servers
  nxos_aaa_server_host:
    state: present
    server_type: tacacs
    address: "{{ item.ip }}"
    tacacs_port: "{{ item.port }}"
    host_timeout: "{{ item.timeout }}"
  with_items: "{{ aaa_servers.tacacs }}"
  when: >
    ansible_network_os == 'nxos' and
    aaa_servers.tacacs is defined
  tags: 
    - aaa_config